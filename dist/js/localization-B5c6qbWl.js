jQuery(function(){var l=jQuery("body"),c=jQuery("<div />").addClass("localization-menu-overlay").appendTo(l);c.bind("click",function(){l.trigger("localizationmenucloseall")}),l.bind("localizationinit",function(n){var d=jQuery(n.target);n.stopPropagation();var o;if(d.is(".field.i18n")?o=d:o=d.find(".field.i18n"),!(o.length<1)){o.bind("localizationmenuopen",function(){var i=jQuery(this);l.trigger("localizationmenucloseall");var a=i.data("localization-menu");i.attr("data-localization-menu-open",!0),a.appendTo(l),i.trigger("localizationmenuposition"),c.show(),a.show()}),o.bind("localizationmenuclose",function(){var i=jQuery(this),a=i.data("localization-menu"),t=i.data("localization-switch");a.hide().appendTo(t),c.hide(),i.removeAttr("data-localization-menu-open")}),o.bind("localizationmenutoggle",function(){var i=jQuery(this),a=i.attr("data-localization-menu-open")?"localizationmenuclose":"localizationmenuopen";i.trigger(a)}),o.bind("localizationmenuposition",function(){var i=jQuery(this);if(i.attr("data-localization-menu-open")){var a=i.data("localization-menu"),t=i.data("localization-switch-trigger"),e=t.offset();a.css({left:e.left+t.outerWidth()-a.outerWidth(),top:e.top+t.outerHeight()})}}),o.find(".localization-switch .trigger").click(function(){jQuery(this).closest(".field.i18n").trigger("localizationmenutoggle")}),o.find(".localization-menu-items button").click(function(){var i=jQuery(this),a=i.attr("data-locale"),t=i.closest(".localization-menu-items"),e=t.data("field"),r=e.find('.localization[data-locale="'+a+'"]');l.trigger("localizationmenucloseall"),r.trigger("localizationlocaleactivate")}),o.bind("localizationlocaleset",function(i,a){var t=jQuery(this),e=a.locale,r=t.find(".localization[data-locale]"),u=r.filter('[data-locale="'+e+'"]'),f=r.not(u);u.addClass("active"),f.removeClass("active");var g=t.find(".localization-switch .trigger .label");g.text(e)}),o.find(".localization").bind("localizationlocaleactivate",function(){var i=jQuery(this),a=i.attr("data-locale"),t=i.closest("form");t.find(".field.i18n").trigger("localizationlocaleset",{locale:a}),l.trigger("settingssave",["arbory.i18n.locale",a])});var s='input[type!="hidden"],textarea,select';o.find(s).bind("focusprepare",function(i){var a=jQuery(i.target).closest(".localization");a.length<1||a.is(".active")||a.trigger("localizationlocaleactivate")}),o.each(function(){var i=jQuery(this),a=i.find(".localization-switch").first();i.data("localization-switch",a),i.data("localization-switch-trigger",a.find(".trigger").first());var t=a.find("menu").first();i.data("localization-menu",t),t.data("field",i)})}}),l.bind("localizationmenucloseall",function(){l.find(".field.i18n[data-localization-menu-open]").trigger("localizationmenuclose")}),l.on("contentloaded",function(n){jQuery(n.target).trigger("localizationinit")})});
